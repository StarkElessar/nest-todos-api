# Docker command

## Чистка памяти на Ubuntu

1. Очистка неиспользуемых объектов

Docker предоставляет встроенную команду для удаления 
всех неиспользуемых объектов (образы, контейнеры, тома, сети):

```bash
  sudo docker system prune
```

Эта команда удаляет:

+ Остановленные контейнеры.
+ Неиспользуемые сети.
+ "Висячие" образы (те, которые не связаны с текущими контейнерами).
+ Неиспользуемые build-кеши.

2. Удаление всех остановленных контейнеров
```bash
  sudo docker container prune
```

3. Удаление неиспользуемых образов
```bash
  sudo docker image prune
```

Чтобы удалить **все образы**, включая те, которые используются:
```bash
  sudo docker image prune -a
```

4. Удаление неиспользуемых томов
```bash
  sudo docker volume prune 
```

5. Удаление неиспользуемых сетей
```bash
  sudo docker network prune
```

6. Очистка build-кеша
```bash
  sudo docker builder prune --all
```

7. Очистка всего **(осторожно!)**
```bash
  sudo docker system prune -a --volumes
```

### Просмотр используемого пространства
```bash
  sudo docker system df
```

### Автоматическая очистка (для Docker 17.06.1 и выше)
Docker может автоматически удалять неиспользуемые объекты при сборке образов. 
Для этого нужно добавить флаг `--force-rm` при сборке:
```bash
  sudo docker build --force-rm -t my-image .
```

##  Запуск образа, контейнера

1. Проверка статуса контейнера:
```bash
  sudo docker ps 
```

2. Сборка Docker-образа:
```bash
  docker build -t [указать_имя_образа] .
```

3. Запуск контейнера:
```bash
  docker run -d --name [указать_имя_контейнера] -p 5432:5432 [указать_имя_образа_для_запуска]
```

4. Подключение к бд внутри контейнера:
```bash
    psql -h localhost -U [имя_пользователя] -d [имя_бд]
```

+ `-h localhost` — хост (ваш контейнер работает на localhost).
+ `-U [имя_пользователя]` — пользователь, которого вы указали в POSTGRES_USER.
+ `-d [имя_бд]` — база данных, которую вы указали в POSTGRES_DB.